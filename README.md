## True Random Number Generator

Some facts of PRNG(Pseudo Random Number Generator)

- Python's `random()` function use the current system time as the default init seed.
- In Python, we can use `random.seed()` to initialize the generator. Then, the random number series generated by `random.random()` is determined by the seed.
- In Go, we can use `rand.Rand.Seed(seed int64)` to initialize the generator.

### Ways to get the seed

1. Use the fingerprint of the runtime machine as a part of the seed, such as MAC address. It could be replayable on the specific machine.
2. Collect randomness from the nature, such as fingerprint, the movement of the mouse on the screen. It's not convenient for automation.
3. Use one or more internal steps to make the progresss more compex, such as Sha256 or provide a random number as the seed of new random generator. It's insecure to prevent from being cracked by the person who develop the system.

So, the full automation and true randomness from nature is contradictory. There must be at least one true randomness in the system, and the other randomness could be generated from the root randomness with simple or complex steps.

So we can choose a root true randomness in our favorite ways.

I got a true randomness `0a1b2f65373c93ea74ff8c0e84b3068feaad149b44efbdcb98061ffefa5dfb83` from the [Drand](https://drand.love/) and drop it's corresponding round number. Alrough attacker could loop on the round numbers and try for each to get the root randomness. The less people known about this root randomness, the secure it will be as well.

Combined with the approach 3, the system security is leveled up.

#### Update

Library [fortuna](https://github.com/seehuhn/fortuna) implemented the Fortuna algorithm. It accept updates of randomness from the environment.

### References

- [梅森旋转算法 - 维基百科](https://zh.wikipedia.org/wiki/%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95) which is used in many languages and libraries.
- [Random number generation - Wikipedia](https://en.wikipedia.org/wiki/Random_number_generation)
  - Fortuna [random(4)](https://www.freebsd.org/cgi/man.cgi?query=random&apropos=0&sektion=4&manpath=FreeBSD+11.0-RELEASE+and+Ports&arch=default&format=html)
- [bitaddress.org](https://www.bitaddress.org)

## Generate HD SegWit Bitcoin Address

### HD Wallet

- ECDSA
- secp256k1
- chain code
- extended private/public key
- normal/hardended child key: With non-hardened keys, you can prove a child public key is linked to a parent public key using just the public keys. You can also derive public child keys from a public parent key, which enables watch-only wallets. With hardened child keys, you cannot prove that a child public key is linked to a parent public key.
- CKDpriv; CKDpub(only for non-hardened child keys)
- Sha256, Base58, HMAC-SHA512
- Base58-encoded address = address version + pubkey hash + checksum
- change addresses, return transaction change

#### References

- Mnemonic code for generating deterministic keys [bips/bip-0039](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)
- Hierarchical Deterministic Wallets [bips/bip-0032](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)
- Multi-Account Hierarchy for Deterministic Wallets [bips/bip-0044](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)
- Registered coin types for BIP-0044 [slips/slip-0044.md](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)
- [理解开发 HD 钱包涉及的 BIP32、BIP44、BIP39](https://learnblockchain.cn/2018/09/28/hdwallet/)
- [BIP39 - Mnemonic Code](https://iancoleman.io/bip39/#english) online tool
- [Bitcoin Private Key - BitcoinWiki](https://en.bitcoinwiki.org/wiki/Private_key)
- [Base58Check encoding - Bitcoin Wiki](https://en.bitcoin.it/wiki/Base58Check_encoding)
- [4. Keys, Addresses, Wallets - Mastering Bitcoin](https://www.oreilly.com/library/view/mastering-bitcoin/9781491902639/ch04.html)

### SegWit Address

- SegWit is the process by which the block size limit on a blockchain is increased by removing signature data from bitcoin transactions. When certain parts of a transaction are removed, this frees up space or capacity to add more transactions to the chain. Segregate means to separate, and witnesses are the transaction signatures. Hence, segregated witness, in short, means to separate transaction signatures.
- hard/soft forks
- Merkle Tree Root
- Block
    - Coinbase
    - transaction
        - TXID
        - version
            - set of rules
        - inputs 
            - TXID
            - vout
            - signature script
        - outputs
            - TXID
            - Output index (vout)
            - pubkey script
            - UTXOs (cannot be spent for at least 100 blocks)
            - Full Public Key
        - Locktime
- Pay-To-Public-Key-Hash (P2PKH)
- script languagae: stack based, stateless and not Turing complete

#### References

- [Cryptocurrency standards - Trezor Wiki](https://wiki.trezor.io/Cryptocurrency_standards)
- [Developer Glossary - Bitcoin](https://btcinformation.org/en/developer-glossary)
- [Developer Guide - Bitcoin](https://btcinformation.org/en/developer-guide)
- [Segregated Witness - Bitcoin Wiki](https://en.bitcoin.it/wiki/Segregated_Witness)
    - [Payment channels - Bitcoin Wiki](https://en.bitcoin.it/wiki/Payment_channels)
    - [Lightning Network - Bitcoin Wiki](https://en.bitcoin.it/wiki/Lightning_Network)
    - [比特币隔离见证和闪电网络有什么关系？](https://www.528btc.com/bk/2019111158642.html)
- Derivation scheme for P2WPKH-nested-in-P2SH based accounts [bips/bip-0049](https://github.com/bitcoin/bips/blob/master/bip-0049.mediawiki)
    - Segregated Witness [bips/bip-0141](https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki)
- Derivation scheme for P2WPKH based accounts [bips/bip-0084](https://github.com/bitcoin/bips/blob/master/bip-0084.mediawiki)
    - Base32 address format for native v0-16 witness outputs [bips/bip-0173](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki)
- [Script - Bitcoin Wiki](https://en.bitcoin.it/wiki/Script)
    - OP_HASH160: The input is hashed twice: first with SHA-256 and then with RIPEMD-160.
    - OP_HASH256: The input is hashed two times with SHA-256.
- [Difference between SegWit and Legacy address](https://help.crypto.com/en/articles/4056348-send-and-receive-btc-ltc-difference-between-segwit-and-legacy-address)
- [What is P2PK, P2PKH, P2SH, P2WPKH - ELI5](https://bitcoin.stackexchange.com/questions/64733/what-is-p2pk-p2pkh-p2sh-p2wpkh-eli5)
- [modood/btckeygen: A very simple and easy to use bitcoin(btc) key/wallet generator.](https://github.com/modood/btckeygen)

## Generate n-out-of-m Multisig P2SH Bitcoin Address

### P2SH

#### References

- [Pay to script hash - Bitcoin Wiki](https://en.bitcoin.it/wiki/Pay_to_script_hash)
- Pay to Script Hash [bips/bip-0016](https://github.com/bitcoin/bips/blob/master/bip-0016.mediawiki)

### MultiSig

#### References

- [Multi-signature - Bitcoin Wiki](https://en.bitcoin.it/wiki/Multi-signature)